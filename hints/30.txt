════════════════════════════════════════
LESSON 30: Leaf Functions
════════════════════════════════════════

WHAT IS A LEAF FUNCTION?

A function that doesn't call any other functions.
Like a "leaf" on a tree - it's at the end of the call chain.


WHY ARE THEY SPECIAL?

Leaf functions often don't need a stack frame at all!

If you don't call other functions:
  - No need to save the return address (it stays in the stack)
  - No need to save callee-save registers (if you don't use them)


THE CALLING CONVENTION

System V AMD64 (Linux) passes arguments in registers:

  Argument 1:  %rdi
  Argument 2:  %rsi
  Argument 3:  %rdx
  Argument 4:  %rcx
  Argument 5:  %r8
  Argument 6:  %r9

  Return value: %rax


A MINIMAL ADD FUNCTION

  add:
      movq %rdi, %rax     # Copy first arg to return register
      addq %rsi, %rax     # Add second arg
      ret                 # Return

That's it! No push, no pop, no stack frame.


WHEN CAN YOU SKIP THE STACK FRAME?

  ✓ You don't call other functions
  ✓ You only use caller-save registers (rax, rcx, rdx, rsi, rdi, r8-r11)
  ✓ You don't need local variables on the stack


YOUR TASK

Write the simplest possible add function:
  - Take two arguments from %rdi and %rsi
  - Return their sum in %rax
  - Just 2-3 instructions!
